#!/bin/bash

if [ -d /etc/firewalld/zones ]; then

    PATH=/bin:/sbin:/usr/bin:/usr/sbin
    (
    egrep -e "<source address=.*>" /etc/firewalld/zones/*xml 2> /dev/null \
        | awk -F\" '{print $2}' \
        | sed -e '/\/32$/s///g' \
        | egrep -e '^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])($|\/([0-9]|[1-2][0-9]|3[0-2])$)' \
        | sort -uV

    ) 2> /dev/null
fi
